<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
    <script src="http://underscorejs.org/underscore-min.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="/static/js/controller.js"></script>
    <script type="text/javascript" src="/static/js/view.js"></script>
    <script type="text/javascript" src="/static/js/select2/select2.js"></script>
</head>
<body>
    <select id="target">
        <option>2000 BM19</option>
        <option>1980 RC1</option>
        <option>1988 XB</option>
        <option>1989 ML</option>
        <option>1989 UQ</option>
        <option>1991 DB</option>
        <option>1991 XB</option>
        <option>1992 BF</option>
        <option>1992 EU</option>
        <option>1992 NA</option>
        <option>1992 QN</option>
        <option>1992 TC</option>
        <option>1992 UB</option>
        <option>1994 AH2</option>
        <option>1995 BC2</option>
        <option>1995 BL2</option>
        <option>1995 WQ5</option>
        <option>1996 BZ3</option>
        <option>1996 FG3</option>
        <option>1997 AC11</option>
        <option>1997 AQ18</option>
        <option>1997 RT</option>
        <option>1997 XF11</option>
        <option>1998 HT31</option>
        <option>1998 KU2</option>
        <option>1998 UT18</option>
        <option>1999 CW8</option>
        <option>1999 HF1</option>
        <option>1999 JD6</option>
        <option>1999 JM8</option>
        <option>1999 JU3</option>
        <option>1999 JV6</option>
        <option>1999 KV4</option>
        <option>1999 SE10</option>
        <option>1999 VN6</option>
        <option>1999 YK5</option>
        <option>2000 BG19</option>
        <option>2000 CE59</option>
        <option>2000 CK33</option>
        <option>2000 CN33</option>
        <option>2000 CO101</option>
        <option>2000 LC16</option>
        <option>2000 RW37</option>
        <option>2000 WC67</option>
        <option>2000 WJ10</option>
        <option>2000 WK10</option>
        <option>2000 WL10</option>
        <option>2000 WO107</option>
        <option>2000 YH66</option>
        <option>2000 YO29</option>
        <option>2001 CC21</option>
        <option>2001 HA8</option>
        <option>2001 HK31</option>
        <option>2001 HW15</option>
        <option>2001 PD1</option>
        <option>2001 SG10</option>
        <option>2001 SJ262</option>
        <option>2001 TY44</option>
        <option>2001 UC5</option>
        <option>2001 UY4</option>
        <option>2001 WH2</option>
        <option>2001 XS1</option>
        <option>2001 XS30</option>
        <option>2001 YK4</option>
        <option>2002 AD9</option>
        <option>2002 AH29</option>
        <option>2002 AL31</option>
        <option>2002 AU5</option>
        <option>2002 AV</option>
        <option>2002 BM26</option>
        <option>2002 BP26</option>
        <option>2002 BP26</option>
        <option>2002 CE26</option>
        <option>2002 CS11</option>
        <option>2002 DH2</option>
        <option>2002 DO3</option>
        <option>2002 DY3</option>
        <option>2002 EA</option>
        <option>2002 EC</option>
        <option>2005 YU55</option>
        <option>A''Hearn</option>
        <option>Aegina</option>
        <option>Aethra</option>
        <option>Alexandra</option>
        <option>Alvarez</option>
        <option>Amalia</option>
        <option>Amy</option>
        <option>Ani</option>
        <option>Anteros</option>
        <option>Antiope</option>
        <option>Apollonia</option>
        <option>Appenzella</option>
        <option>Aquitania</option>
        <option>Arachne</option>
        <option>Arsinoe</option>
        <option>Asterope</option>
        <option>Atalante</option>
        <option>Aurelia</option>
        <option>Backlunda</option>
        <option>Barto</option>
        <option>Bathseba</option>
        <option>Baucis</option>
        <option>Bavaria</option>
        <option>Beatty</option>
        <option>Bede</option>
        <option>Beira</option>
        <option>Berbericia</option>
        <option>Berry</option>
        <option>Betulia</option>
        <option>Bezovec</option>
        <option>Bilkis</option>
        <option>Boury</option>
        <option>Bower</option>
        <option>Boznemcova</option>
        <option>Brangane</option>
        <option>Brixia</option>
        <option>Brubeck</option>
        <option>Bryantsev</option>
        <option>Calingasta</option>
        <option>Campania</option>
        <option>Capek</option>
        <option>Carlova</option>
        <option>Celuta</option>
        <option>Ceres</option>
        <option>Chaldaea</option>
        <option>Chloe</option>
        <option>Chloris</option>
        <option>Chukotka</option>
        <option>Clarissa</option>
        <option>Clifford</option>
        <option>Clorinde</option>
        <option>Concordia</option>
        <option>Corduba</option>
        <option>Cornelia</option>
        <option>d''Alembert</option>
        <option>Daphne</option>
        <option>Davida</option>
        <option>Davidharvey</option>
        <option>Decaro</option>
        <option>Delia</option>
        <option>Delila</option>
        <option>Desiderata</option>
        <option>Didymos</option>
        <option>Dionysus</option>
        <option>Dolores</option>
        <option>DuBridge</option>
        <option>Dugan</option>
        <option>Dunham</option>
        <option>Dynamene</option>
        <option>Eger</option>
        <option>Egeria</option>
        <option>Eichhorn</option>
        <option>Eichsfeldia</option>
        <option>Emita</option>
        <option>Endymion</option>
        <option>Erato</option>
        <option>Eugenisis</option>
        <option>Euphrosyne</option>
        <option>Europa</option>
        <option>Eva</option>
        <option>Evelyn</option>
        <option>Faina</option>
        <option>Felicitas</option>
        <option>Feodosia</option>
        <option>Fini</option>
        <option>Flammario</option>
        <option>Fortuna</option>
        <option>Fowler</option>
        <option>Galatea</option>
        <option>Geichenko</option>
        <option>Germania</option>
        <option>Gregory</option>
        <option>Gressmann</option>
        <option>Gyptis</option>
        <option>Hamburga</option>
        <option>Heckmann</option>
        <option>Hedda</option>
        <option>Heracles</option>
        <option>Hersilia</option>
        <option>Hippo</option>
        <option>Hispania</option>
        <option>Horky</option>
        <option>Horn-d''Arturo</option>
        <option>Huenna</option>
        <option>Hygiea</option>
        <option>Idelsonia</option>
        <option>Interamnia</option>
        <option>Irma</option>
        <option>Jekhovsky</option>
        <option>Jo-Ann</option>
        <option>Julia</option>
        <option>Kaho</option>
        <option>Kanaya</option>
        <option>Kani</option>
        <option>Kemi</option>
        <option>Klio</option>
        <option>Kodaira</option>
        <option>Kolga</option>
        <option>Kridsadaporn</option>
        <option>Laurentia</option>
        <option>Lawrence</option>
        <option>Leonardo</option>
        <option>Letaba</option>
        <option>Leukothea</option>
        <option>Levitan</option>
        <option>Liguria</option>
        <option>Lilaea</option>
        <option>Lilio</option>
        <option>Lilliputia</option>
        <option>Loreley</option>
        <option>Lotis</option>
        <option>Lova</option>
        <option>Lucianotesi</option>
        <option>Lucina</option>
        <option>Luisa</option>
        <option>Lumen</option>
        <option>Lunacharsky</option>
        <option>Madreteresa</option>
        <option>Maisica</option>
        <option>Maja</option>
        <option>Makharadze</option>
        <option>Marghanna</option>
        <option>Mathilde</option>
        <option>Megaira</option>
        <option>Melanie</option>
        <option>Miriam</option>
        <option>Misa</option>
        <option>Moira</option>
        <option>Montague</option>
        <option>Nansenia</option>
        <option>Nemausa</option>
        <option>Nephele</option>
        <option>Nereus</option>
        <option>Nicole</option>
        <option>Nora</option>
        <option>Opik</option>
        <option>Orchis</option>
        <option>Osiris</option>
        <option>Oskar</option>
        <option>Ostro</option>
        <option>Paavo Nurmi</option>
        <option>Pallas</option>
        <option>Palma</option>
        <option>Paola</option>
        <option>Parks</option>
        <option>Parvulesco</option>
        <option>Paulharris</option>
        <option>Pax</option>
        <option>Peraga</option>
        <option>Phaethon</option>
        <option>Pirola</option>
        <option>Polana</option>
        <option>Popov</option>
        <option>Poseidon</option>
        <option>Pyotr Pervyj</option>
        <option>Ra-Shalom</option>
        <option>Rebekka</option>
        <option>Roberta</option>
        <option>Robeson</option>
        <option>Rockholt</option>
        <option>Rudra</option>
        <option>Rufino</option>
        <option>Russia</option>
        <option>Sanguin</option>
        <option>Sapientia</option>
        <option>Sarema</option>
        <option>Sayers</option>
        <option>Sazava</option>
        <option>Seleucus</option>
        <option>Semele</option>
        <option>Siegena</option>
        <option>Sigurd</option>
        <option>Sophrosyne</option>
        <option>Storeria</option>
        <option>Svea</option>
        <option>Swann</option>
        <option>Tamara</option>
        <option>Tangshan</option>
        <option>Tapio</option>
        <option>Tarkovskij</option>
        <option>Tatry</option>
        <option>Tauris</option>
        <option>Tercidina</option>
        <option>Thia</option>
        <option>Thisbe</option>
        <option>Vangelis</option>
        <option>Vernadskij</option>
        <option>Vibilia</option>
        <option>Vienna</option>
        <option>Viola</option>
        <option>Vishnu</option>
        <option>Walkure</option>
        <option>Weissman</option>
        <option>Westphalia</option>
        <option>Wilhelmina</option>
        <option>Winchester</option>
        <option>Xanthippe</option>
        <option>Zao</option>
        <option>Zelinda</option>
        <option>Zwetana</option>
    </select>
    <div id="map3d" style="height: 90%; width: 100%;"></div>
    <script>
    var results = {};
    function RemoveAllFeatures()
    {

        var root = window.ge.getLayerRoot();
        var folders = root.getElementsByType('KmlFolder').getLength();

        for (var id = 0; id < folders; id++) {
            // Get all the Folders in the root KML, and hide them
            // This disables the constellations, messier, etc.
            // Basically everything we don't care about
            root.getElementsByType('KmlFolder').item(id).setVisibility(false)
        }

        var features = ge.getFeatures();
        while (features.getLastChild() != null)
        {
        features.removeChild(features.getLastChild());
        }
    }
    $(document).ready(function () {
        $('#go').on('click', function (e) {
            e.preventDefault();

            var target = $('#target').val();
            var link = window.ge.createLink('');
            var href = 'http://' + window.location.host + '/api/kml/search?target=' + target;
            link.setHref(href);

            var networkLink = window.ge.createNetworkLink('');
            networkLink.set(link, true, true); // Sets the link, refreshVisibility, and flyToView

            RemoveAllFeatures()

            window.ge.getFeatures().appendChild(networkLink);
        });

        window.loadMaps = function () {
            google.load("earth", "1", {"callback": function () {
                    google.earth.createInstance('map3d', function (instance) {
                        window.ge = instance;
                        window.ge.getOptions().setMapType(ge.MAP_TYPE_SKY);
                        window.ge.getWindow().setVisibility(true);
                    }, function () {});
            }});
        };

        window.loadMaps();

        window.leapmotion_init = function () {
            var ws = new WebSocket('ws://localhost:6437/');
            // On message received
            ws.onmessage = recieveData;
        };

        window.leapmotion_init();
    });
    </script>
</body>
</html>
